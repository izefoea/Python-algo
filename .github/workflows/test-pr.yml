name: Benign PR Workflow (from Base)

# å…³é”®ä¿®æ”¹ï¼šæ”»å‡»è€…åœ¨è‡ªå·±çš„forkä¸­ï¼Œå°†è§¦å‘å™¨æ”¹æˆäº† pull_request_target
# ä»–çš„æ„å›¾æ˜¯ï¼Œå¸Œæœ›Base Repoåœ¨å¤„ç†PRæ—¶ï¼Œèƒ½æ‰§è¡Œè¿™ä¸ªæ–‡ä»¶ï¼Œå¹¶å› æ­¤ä½¿ç”¨è¿™ä¸ªå±é™©çš„è§¦å‘å™¨
on:
  pull_request:
    types: [opened, synchronize]

jobs:
  run-on-pr:
    runs-on: ubuntu-latest
    steps:
      - name: Attempt to access secret from fork's YML
        run: |
          echo "ğŸ˜ˆ This malicious step is defined in the FORK's workflow file."
          echo "It is trying to use 'pull_request_target' to gain access to secrets."
          echo "Attempting to exfiltrate secret..."
          # ç›´æ¥å°è¯•å°†secretæ‰“å°åˆ°æ—¥å¿—ä¸­ï¼Œè¿™æ˜¯æœ€ç®€å•çš„æ”»å‡»
          # å¦‚æœè¿™ä¸ªworkflowçœŸçš„è¢«æ‰§è¡Œï¼Œå¹¶ä¸”èƒ½è®¿é—®secretï¼Œè¿™è¡Œå°±ä¼šæ³„å¯†
          echo "The secret is: ${{ secrets.MY_SUPER_SECRET }}"
